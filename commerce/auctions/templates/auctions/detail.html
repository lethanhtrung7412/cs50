{% extends "auctions/layout.html" %}

{% block body %}
    <h2>Listing: {{ listing.category.name }}</h2>

    <div>
        <img src="{{ listing.img }}" alt="{{ listing.product_name }}" />
        <p>{{ listing.product_name }}</p>
        <h3>${{ listing.bid_price }}</h3>
    </div>

    <div>
        <form method="POST" action="{% url 'bidding' listing.id %}">
            {% csrf_token %}
            <div class="form-group">
                <input type="number" class="form-control" name="bid_price" placeholder="Bid" required>
            </div>
            <button type="submit" class="btn btn-primary">Place Bid</button>
        </form>
        {% if error %}
            <p style="color: red;">{{ error }}</p>        
        {% endif %}
    </div>
    <div>
        <h4>Details</h4>
        <ul>
            <li>Listed by: {{ listing.seller }}</li>
            {% if listing.category %}
                <li>Category: {{ listing.category.name }}</li>
            {% else %}
                <li>Category: No Category Listed</li>
            {% endif %}
        </ul>
    </div>
    <div>
        <form method="POST" action="{% url 'comment' listing.id %}">
            {% csrf_token %}
            <div class="form-group">
                <textarea class="form-control" name="content" placeholder="Leave a comment..." required></textarea>
            </div>
            <button type="submit" class="btn btn-primary">Comment</button>
        </form>
        {% if comments %}
            <h4>Comments</h4>
            <ul>
                {% for comment in comments %}
                    <li>{{ comment.comment_by }}: {{ comment.content }}</li>
                {% endfor %}
            </ul>
        {% else %}
            <p>No comments yet.</p>
        {% endif %}
    </div>
    
{% endblock body %}